ec.load("ajax");ec.pkg("ec.member.zhima");ec.member.zhima={query:function(){$.ajax({url:domainUc+"/zm/queryZM.json",dataType:"jsonp",timeout:10000,timeoutFunction:function(){alert("\u64cd\u4f5c\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},success:function(a){if(a.resultCode=="200"&&a.userZMInfoVO){if(a.userZMInfoVO.certifyStatus==1){$("#myZhimaPoint").html(a.userZMInfoVO.creditScore)}}}})},jump2Index:function(){window.location.href="/member/zm"},queryFromIndex:function(){var b=$("#creditScore").val();var a=$("#updateTime").val();var c=$("#authFail").val();if(c&&c=="0"){$("#creditLead").hide();$("#canvasContent").hide();$("#myCredit-rz-failed").show();setTimeout("ec.member.zhima.jump2Index()",3000)}else{if(b&&a){ec.member.zhima.pointsShow(b,a);$("#creditLead").hide()}else{$.ajax({url:domainUc+"/zm/queryZM.json",dataType:"jsonp",timeout:10000,timeoutFunction:function(){alert("\u64cd\u4f5c\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")},success:function(d){if(d.resultCode=="200"&&d.userZMInfoVO){if(d.userZMInfoVO.certifyStatus==1){ec.member.zhima.pointsShow(d.userZMInfoVO.creditScore,d.userZMInfoVO.updateTime);$("#creditLead").hide()}else{$("#canvasContent").hide()}}}})}}},auth:function(){if(!ec.form.validator($("#zhima-lead-form"),true)){return}var b=$("#zhimaTelephone").val();var a=domainMain+"/member/zm/show";var c=domainUc+"/zm/certifyZM?mobileNo="+b+"&callbackURL="+a+"&sourceType=pc";window.location.href=c},validateTelephone:function(a){var b=ec.form.validator.bind;b(a.find("#zhimaTelephone"),{type:["require","regex"],validOnChange:true,regex:/^(1[34578])[0-9]{9}$/,msg_ct:a.find("#zhimaTelephoneError"),msg:{require:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801",regex:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801"}})},pointsShow:function(f,j){var k=document.getElementById("canvasContent");var a=document.getElementById("drawingBg");var i=document.getElementById("drawing");var g=document.getElementById("drawingRun");var e=document.getElementById("drawingRunWay");var h=[350,"\u8f83\u5dee",550,"\u4e2d\u7b49",600,"\u826f\u597d",650,"\u4f18\u79c0",700,"\u6781\u597d",950];var d={width:940,height:777,fixed:{parent:k,className:"myCredit-canvas-points"},fixedColor:{0:"#ef5c49",1:"#ff9400",2:"#5dc336 ",3:"#02bbb7",4:"#18a2f5"},colorGradient:{0:{form:"rgb(244,101,60)",to:"rgb(234,86,84)"},1:{form:"rgb(249, 168, 4)",to:"rgb(249, 115, 5)"},2:{form:"rgb(148, 212, 5)",to:"rgb(42, 178, 44)"},3:{form:"rgb(2, 210, 170)",to:"rgb(3, 164, 195)"},4:{form:"rgb(34, 194, 245)",to:"rgb(14, 131, 245)"}},points:f,total:h,circle:{bgObj:a,obj:i,runObj:g,runWayObj:e,x:470,y:390,r1:134,r2:120,r3:115,r4:125}};var c=function(l){var n={0:{form:"rgb(244,101,60)",to:"rgb(234,86,84)"},1:{form:"rgb(249, 168, 4)",to:"rgb(249, 115, 5)"},2:{form:"rgb(148, 212, 5)",to:"rgb(42, 178, 44)"},3:{form:"rgb(2, 210, 170)",to:"rgb(3, 164, 195)"},4:{form:"rgb(34, 194, 245)",to:"rgb(14, 131, 245)"}};var m={0:"#ef5c49",1:"#ff9400",2:"#5dc336 ",3:"#02bbb7",4:"#18a2f5"};this.fixed=l.fixed;this.fixedColor=l.fixedColor||m;this.points=l.points;this.colorGradient=l.colorGradient||n;this.circle=l.circle;this.width=l.width;this.height=l.height};c.prototype={_drawWh:function(){var l=this;l.circle.bgObj.style.width=l.width+"px";l.circle.obj.style.width=l.width+"px";l.circle.runObj.style.width=l.width+"px";l.circle.runWayObj.style.width=l.width+"px";l.circle.bgObj.style.height=l.height+"px";l.circle.obj.style.height=l.height+"px";l.circle.runObj.style.height=l.height+"px";l.circle.runWayObj.style.height=l.height+"px"},_drawBg:function(l){var o=this;var m=o.circle.bgObj.getContext("2d");var n=m.createLinearGradient(0,0,0,o.width);n.addColorStop(0,(o.colorGradient[l].form));n.addColorStop(1,(o.colorGradient[l].to));m.fillStyle=n;m.fillRect(0,0,o.width,o.height)},_draw:function(){var q=this;var o=q.circle.obj.getContext("2d");o.beginPath();o.arc(q.circle.x,q.circle.y,q.circle.r1,157.5/180*Math.PI,(22.5/180+2)*Math.PI);o.lineWidth=3;o.strokeStyle="rgba(255,255,255,0.3)";o.stroke();o.closePath();o.beginPath();o.arc(q.circle.x,q.circle.y,q.circle.r2,157.5/180*Math.PI,(22.5/180+2)*Math.PI);o.lineWidth=10;o.strokeStyle="rgba(255,255,255,0.3)";o.stroke();o.closePath();o.translate(q.circle.x,q.circle.y);for(var m=0;m<16;m++){if(m%6===3){q._drawSpan(o,2,m)}else{q._drawSpan(o,1,m)}}o.font="12px Microsoft YaHei,Arial,sans-serif";o.fillStyle="rgba(255,255,255,0.5)";o.textAlign="center";o.textBaseline="bottom";o.rotate((-7.5*15)/180*Math.PI);for(var m=0;m<11;m++){o.fillText(h[m],0,-94);o.rotate((7.5*3)/180*Math.PI)}o.rotate(-7.5*18/180*Math.PI);var l=j.substring(0,4);var p=j.substring(4,6);var n=j.substring(6,8);o.fillText(("\u66f4\u65b0\u65f6\u95f4\uff1a"+l+"."+p+"."+n),0,80);o.font="14px Microsoft YaHei,Arial,sans-serif";o.fillStyle="rgba(255,255,255,0.3)";o.fillText("BETA",0,-40)},_judge:function(r){var o=this;var s=0;var p=0;var q="";var l=0;var n=0;var t=0;if(r<550&&r>=350){s=(r-350);p=(r-350)*(1/200);q="\u8f83\u5dee";l=0;n=0;t=200}else{if(r<600&&r>=550){s=(r-550);p=(r-550)*(1/50);q="\u4e2d\u7b49";l=1;n=45;t=50}else{if(r<650&&r>=600){s=(r-600);p=(r-600)*(1/50);q="\u826f\u597d";l=2;n=90;t=50}else{if(r<700&&r>=650){s=(r-650);p=(r-650)*(1/50);q="\u4f18\u79c0";l=3;n=135;t=50}else{if(r<=950&&r>=700){s=(r-700);p=(r-700)*(1/250);q="\u6781\u597d";l=4;n=180;t=250}}}}}var m=s/t*45+n;return{value:s,rValue:p,eValue:q,gValue:l,dValue:n,span:t,angle:m}},_run:function(){var r=this;var m;var o=0;var t=r.circle.runObj.getContext("2d");var q=r.circle.runWayObj.getContext("2d");t.translate(r.circle.x,r.circle.y);q.translate(r.circle.x,r.circle.y);var s=r.points||350;s=s>950?950:s;s=s<350?350:s;r._judge();r._drawBg(0);var n=r._judge(s).angle;function p(v){var u=0;if(n<45){u=v/90}else{if(n<90){u=v/135}else{if(n<135){u=v/180}else{if(n<180){u=v/225}else{if(n<=225){u=v/270}}}}}q.translate(-r.circle.x,-r.circle.y);q.translate(r.circle.x,r.circle.y);q.beginPath();q.arc(-r.circle.r1*Math.sin((v+67.5)/180*Math.PI),r.circle.r1*Math.cos((v+67.5)/180*Math.PI),1,0,2*Math.PI,true);q.fillStyle="rgba(255,255,255,"+u+")";q.strokeStyle="rgba(255,255,255,"+u+")";q.fill();q.stroke();q.closePath()}function l(){t.translate(-r.circle.x,-r.circle.y);t.clearRect(0,0,r.width,r.height);t.translate(r.circle.x,r.circle.y);o++;t.beginPath();t.shadowBlur=10;t.shadowColor="#fff";t.arc(-r.circle.r1*Math.sin((o+67.5)/180*Math.PI),r.circle.r1*Math.cos((o+67.5)/180*Math.PI),4,0,2*Math.PI,true);t.fillStyle="#fff";t.fill();t.strokeStyle="rgb(255,255,255)";t.stroke();t.closePath();var u;if(o<45){u=o/45*200+350;r._drawBg(0)}else{if(o<90){u=(o-45)/45*50+550;r._drawBg(1)}else{if(o<135){u=(o-90)/45*50+600;r._drawBg(2)}else{if(o<180){u=(o-135)/45*50+650;r._drawBg(3)}else{if(o<=225){u=(o-180)/45*250+700;r._drawBg(4)}}}}}u=u>s?s:u;t.shadowBlur=0;t.font="60px Arial";t.textAlign="center";t.textBaseline="bottom";t.fillText(parseInt(u),0,20);t.font="24px Microsoft YaHei";t.fillText("\u4fe1\u7528"+r._judge(s).eValue,0,50);p(o);if(o>=n){clearTimeout(m)}else{m=setTimeout(l,u/s*15)}}l()},_drawSpan:function(n,m,l){var o=this;n.beginPath();n.lineWidth=m;n.strokeStyle="rgba(255,255,255,0.5)";n.moveTo(o.circle.r3*Math.sin(7.5*l/180*Math.PI),-o.circle.r3*Math.cos(7.5*l/180*Math.PI));n.lineTo(o.circle.r4*Math.sin(7.5*l/180*Math.PI),-o.circle.r4*Math.cos(7.5*l/180*Math.PI));n.moveTo(-o.circle.r3*Math.sin(7.5*l/180*Math.PI),-o.circle.r3*Math.cos(7.5*l/180*Math.PI));n.lineTo(-o.circle.r4*Math.sin(7.5*l/180*Math.PI),-o.circle.r4*Math.cos(7.5*l/180*Math.PI));n.stroke();n.closePath()},_fixed:function(){var p=$(".section-header").height(),s=$(".mc-menu-area").height(),n=$(".myCredit-rz").height();$("#canvasContent").css({height:s-p-20+"px"});var o=this;o.fixed.parent.style.backgroundColor=o.fixedColor[o._judge(f).gValue];var t=document.createElement("div");var l=j.substring(0,4);var r=j.substring(4,6);var q=j.substring(6,8);var m=l+"."+r+"."+q;t.innerHTML='<p class="title">'+f+'</p><p class="credit">\u4fe1\u7528'+o._judge(f).eValue+'</p><p class="time">\u66f4\u65b0\u65f6\u95f4\uff1a'+m+"</p>";t.className=o.fixed.className;o.fixed.parent.appendChild(t)},show:function(){var o=this;o._drawWh();var m=$(".section-header").height(),n=$(".mc-menu-area").height(),l=$(".myCredit-rz").height();$("#drawingBg").css({height:n-m-20+"px"});if(o.circle.obj.getContext){o._draw();o._run()}else{o._fixed()}}};var b=new c(d);b.show()}};ec.ready(function(){ec.member.zhima.validateTelephone($("#zhima-lead-form"))});

ec.pkg("ec.member.orderList");ec.load("ajax");ec.load("ec.box",{loadType:"lazy"});ec.load("jquery.movebar");ec.member.orderList.openAddRemarkView=function(a){$.ajax({url:"/member/addUserRemarkView?orderCode="+a+"&t="+new Date().getTime(),dataType:"jsonp",success:function(c){var d=$(c);if(d.length==1&&d.hasClass("errorMsg")){var b=encodeURIComponent(d.text());window.location.href="/member/prdRemark/errorMsg?msg="+b}else{$("div.u-4-5").html(c);ec.member.add.showView()}}})};ec.member.orderList.getUserOrderRemarkStatus=function(c){if($("#colid").val()=="0"||c=="0"){return}var a="";var b=true;$(".button-operate-revie").each(function(){if(b){a=$(this).attr("orderInfo");b=false}else{a+=","+$(this).attr("orderInfo")}});if(a!=""){new ec.ajax().get({url:domainRms+"/comment/getOrderCommentStatus.json?t="+new Date().getTime(),dataType:"jsonp",data:{orderCode:a},timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},successFunction:function(d){$(".button-operate-revie").each(function(){var g;var f=$(this).attr("orderInfo");if(d.data&&d.data!=undefined){for(var e=0;e<d.data.length;e++){g=d.data[e];if((f==g.orderCode)&&(g.status==1)){$(this).attr("href","javascript:ec.member.orderList.commentsRealName("+g.orderCode+")");$(this).attr("title","我要评论");$(this).attr("innerHTML","<span>我要评论</span>");$(this).parent(".p-button").removeClass("hide")}}}})}})}};ec.member.orderList.commentsRealName=function(a){new ec.ajax().get({url:domainMain+"/member/addUserRemarkView.json?t="+new Date().getTime(),dataType:"json",data:{orderCode:a},timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},successFunction:function(b){if(b.success){window.location.href="/member/addUserRemarkView?orderCode="+a}else{ec.account.syncCustomSession(function(c){if(c==null||c.customerInfo.userState==null){window.location.href="/member/addUserRemarkView?orderCode="+a;return}else{ec.member.orderList.vildateComments(a)}})}}})};ec.member.orderList.vildateComments=function(a){new ec.ajax().get({url:domainMain+"/member/addUserRemarkView.json?t="+new Date().getTime(),dataType:"json",data:{orderCode:a},timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},successFunction:function(b){if(b.success){window.location.href="/member/addUserRemarkView?orderCode="+a}else{ec.member.orderList.commentsTip()}}})};ec.member.orderList.commentsTip=function(){new ec.box($("#realNameComment").val(),{boxclass:"ol_box_4",title:"",width:540,showButton:false,autoHeight:false,onok:function(){}}).open()};ec.member.orderList.unpayTip=function(){new ec.box($("#unPay-inOnce").val(),{boxclass:"ol_box_4 small",title:"",showButton:false,autoHeight:false,onok:function(){}}).open()};ec.ready(function(){ec.account.dapPushMsg("","","view");$("#ec_ui_confirm").click(function(b){b=b||window.event;b.stopPropagation()});$(document).bind("click",function(c){var c=c||window.event;var b=c.target||c.srcElement;if(b.innerHTML!="取消订单"&&b.innerHTML!="删除订单"){$("#ec_ui_confirm").hide()}});$("#li-order").addClass("current");$("#pathTitle").html("我的订单");ec.member.orderList.interfaceTpl=new ec.template($("#interface-tpl").val());window.onhashchange=function(){var b=window.location.hash;if(b&&b.length>0){b=b.substring(1,b.length);if(b.length>0){ec.member.orderList.openAddRemarkView(b)}else{window.location.reload()}}else{window.location.reload()}};var a=window.location.hash;if(a&&a.length>0){a=a.substring(1,a.length);if(a.length>0){ec.member.orderList.openAddRemarkView(a);return}}ec.member.orderList.getUserOrderRemarkStatus();if($(".list-group-item").length<1){$("#order-merge-pay").hide()}});ec.member.orderList.load=function(d){var b,a,c,e;if($("#checkid").val()=="nocomment"){b=domainRms+"/comment/getNoCommentOrders.json?t="+new Date().getTime();a="jsonp";c=0;e={pageNum:d.pageNumber,pageSize:5}}else{b=domainMain+"/member/order.json?t="+new Date().getTime();a="json";c=1;e={dateType:$("#colid").val(),tab:$("#checkid").val(),pageNumber:d.pageNumber,pageSize:5}}new ec.ajax().get({url:b,dataType:a,data:e,timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},beforeSendFunction:function(){ec.ui.loading.show({modal:false})},afterSendFunction:ec.ui.loading.hide,successFunction:function(f){if(0==c){if(f.resultCode!=0){if(f.resultCode=="42003"){ec.account.loginName="";ec.account.afterLogin(function(){ec.member.orderList.load(d)})}else{alert("很抱歉！订单列表查询失败，请稍后重新操作")}return}}else{if(!f.success){if(f.code=="login"){ec.account.loginName="";ec.account.afterLogin(function(){ec.member.orderList.load(d)})}else{alert("很抱歉！订单列表查询失败，请稍后重新操作")}return}}ec.member.orderList.push(f,c);if(f.orderList&&f.orderList.length>0){if($("input[name='payCheck']").length==0||$("input[name='payCheck']").length==1){$("#myOrder-control-bottom").hide();$("#myOrder-control-bottom-up").hide()}else{$("#checkAllBox").attr("checked",false);$("#bottomCheckAllBox").attr("checked",false);$("#myOrder-control-bottom").show();$("#myOrder-control-bottom-up").show()}}else{$("#myOrder-control-bottom").hide();$("#myOrder-control-bottom-up").hide()}}})};ec.member.orderList.push=function(v,r){var h=[],m,u,d,g,o=$("#colid").val(),l="",w="",b="";if(0==r){d=v.data.orderList;g=v.data.page}else{d=v.orderList;g=v.page}if(d&&d.length>0){for(var t=0;t<d.length;t++){var e;m=d[t];u=(o==0&&m.isHisData==0)?"0":"1",b=(m.paymentStatus==1)?"已付款":"待支付";if(m.orderClearing!=null){e="true"}else{e="false"}if(m.orderStatus=="4"||m.orderStatus=="8"){l=(new Date(m.orderDate)).format("yyyy-MM-dd")+"&nbsp;&nbsp;"+(new Date(m.orderDate)).format("HH:mm");w=b}else{if(m.orderStatus=="7"){l=(new Date(m.orderDate)).format("yyyy-MM-dd")+"&nbsp;&nbsp;"+(new Date(m.orderDate)).format("HH:mm");w=ec.encodeForHTML(m.orderStatusText)+"&nbsp;|&nbsp;"+ec.encodeForHTML(b)}else{l=(new Date(m.orderDate)).format("yyyy-MM-dd")+"&nbsp;&nbsp;"+(new Date(m.orderDate)).format("HH:mm");w=(m.orderStatus=="6")?b:(ec.encodeForHTML(m.orderStatusText)+"&nbsp;|&nbsp;"+ec.encodeForHTML(b))}}h.push('<div class="list-group-item"><div class="o-info">');if(m.orderStatus==8){h.push('<div class="col-info">');var a=m.type!=18&&(m.paymentStatus==2||m.paymentStatus==3)&&(m.orderStatus==3||(m.orderStatus<3&&m.orderSource!=2));if(a){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+m.paymentStatus+'"clearOrder="'+e+'" value="'+m.orderCode+'"/>')}if(m.type==22){h.push('<span class="o-icon">奖品</span>')}h.push('<span class="o-date">'+l+'</span><span class="o-no">订单号：');h.push('<a href="/member/order-'+m.orderCode+"?isHisData="+u+'" title="'+m.orderCode+'">'+m.orderCode+"</a></span>");if(m.type==33){h.push('<span class="o-icon-1">拼购</span>')}if(m.type==26){h.push('<span class="icon-priority"></span>')}h.push('</div><div class="col-state">');if(m.paymentStatus==1){h.push("已取消&nbsp;|&nbsp;已付款")}else{if(m.paymentStatus==2){h.push("已取消")}else{if(m.paymentStatus==3){if(m.type==18){h.push("已支付订金")}else{h.push("已部分付款")}}else{h.push("待支付")}}}h.push("</div>")}else{if(m.orderStatus==12){h.push('<div class="col-info">');var a=m.type!=18&&(m.paymentStatus==2||m.paymentStatus==3)&&(m.orderStatus==3||(m.orderStatus<3&&m.orderSource!=2));if(a){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+m.paymentStatus+'"clearOrder="'+e+'" value="'+m.orderCode+'"/>')}if(m.type==22){h.push('<span class="o-icon">奖品</span>')}h.push('<span class="o-date">'+l+'</span><span class="o-no">订单号：');h.push('<a href="/member/order-'+m.orderCode+"?isHisData="+u+'" title="'+m.orderCode+'">'+m.orderCode+"</a></span>");if(m.type==33){h.push('<span class="o-icon-1">拼购</span>')}if(m.type==26){h.push('<span class="icon-priority"></span>')}h.push('</div><div class="col-state">');if(m.paymentStatus==2){h.push("关闭支付&nbsp;|&nbsp;未支付")}else{if(m.paymentStatus==1){h.push("关闭支付&nbsp;|&nbsp;已支付")}else{h.push("关闭支付&nbsp;|&nbsp;待支付")}}h.push("</div>")}else{if(m.orderStatus==7){h.push('<div class="col-info">');var a=m.type!=18&&(m.paymentStatus==2||m.paymentStatus==3)&&(m.orderStatus==3||(m.orderStatus<3&&m.orderSource!=2));if(a){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+m.paymentStatus+'"clearOrder="'+e+'" value="'+m.orderCode+'"/>')}if(m.type==22){h.push('<span class="o-icon">奖品</span>')}h.push('<span class="o-date">'+l+'</span><span class="o-no">订单号：');h.push('<a href="/member/order-'+m.orderCode+"?isHisData="+u+'" title="'+m.orderCode+'">'+m.orderCode+"</a></span>");if(m.type==33){h.push('<span class="o-icon-1">拼购</span>')}if(m.type==26){h.push('<span class="icon-priority"></span>')}if(m.type==28||m.type==36){}else{h.push('<span class="o-logistics">');h.push('<a href="javascript:;" onmouseover="ec.member.orderList.openLog(this, '+m.orderCode+')">物流信息</a>');h.push('<div class="o-logistics-record" id="interface-dialog-'+m.orderCode+'">');h.push('<div class="o-logistics-list" id="interface-msg-'+m.orderCode+'">');h.push('<div class="o-logistics-list-loading">加载中</div></div><s></s></div></span>')}h.push('</div><div class="col-state">'+ec.encodeForHTML(m.orderStatusText)+"&nbsp;|&nbsp;");if(m.paymentStatus==1){h.push("已付款")}else{if(m.paymentStatus==2){h.push("已取消")}else{h.push("待支付")}}h.push("</div>")}else{h.push('<div class="col-info">');var a=m.type!=18&&(m.paymentStatus==2||m.paymentStatus==3)&&(m.orderStatus==3||(m.orderStatus<3&&m.orderSource!=2));if(a){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+m.paymentStatus+'"clearOrder="'+e+'" value="'+m.orderCode+'"/>')}if(m.type==22){h.push('<span class="o-icon">奖品</span>')}h.push('<span class="o-date">'+l+'</span><span class="o-no">订单号：');h.push('<a href="/member/order-'+m.orderCode+"?isHisData="+u+'" title="'+m.orderCode+'">'+m.orderCode+"</a></span>");if(m.type==33){h.push('<span class="o-icon-1">拼购</span>')}if(m.type==26){h.push('<span class="icon-priority"></span>')}if(m.orderStatus==6){if(m.type==28||m.type==36){}else{h.push('<span class="o-logistics">');h.push('<a href="javascript:;" onmouseover="ec.member.orderList.openLog(this, '+m.orderCode+')">物流信息</a>');h.push('<div class="o-logistics-record" id="interface-dialog-'+m.orderCode+'">');h.push('<div class="o-logistics-list" id="interface-msg-'+m.orderCode+'">');h.push('<div class="o-logistics-list-loading">加载中</div></div><s></s></div></span>')}}h.push('</div><div class="col-state">');if(m.orderStatus==4){h.push("审核未通过&nbsp;|&nbsp;")}else{if(m.orderStatus==12){h.push("关闭支付&nbsp;|&nbsp;")}else{if(m.orderStatus==3){h.push("审核通过&nbsp;|&nbsp;")}else{if(m.orderStatus==9){h.push("正在出库&nbsp;|&nbsp;")}else{if(m.orderStatus==5){h.push("已出库&nbsp;|&nbsp;")}else{if(m.orderStatus==6||m.orderStatus==15){h.push("已发货&nbsp;|&nbsp;")}else{if(m.orderStatus==7){h.push("已完成&nbsp;|&nbsp;")}else{if(m.orderStatus==14){h.push("已拒收&nbsp;|&nbsp;")}else{if(m.orderStatus==16){h.push("取消处理中&nbsp;|&nbsp;")}else{if(m.orderStatus==17){h.push("修改处理中&nbsp;|&nbsp;")}else{h.push(ec.encodeForHTML(m.orderStatusText)+"&nbsp;|&nbsp;")}}}}}}}}}}if(m.paymentStatus==1){h.push("已付款")}else{if(m.paymentStatus==3){h.push("已部分付款")}else{h.push("待支付")}}h.push("</div>")}}}h.push('</div><div class="o-pro"><table border="0" cellpadding="0" cellspacing="0"><tbody>');h.push(ec.member.orderList.productList(m));h.push("</tbody></table></div>");if(m.type==18){h.push(ec.member.orderList.depositList(m))}h.push("</div>")}$("#list-group").html(h.join(""));if($("#checkid").val()=="nocomment"){var c=[];for(var t=0;t<d.length;t++){for(var s=0;s<d[t].productList.length;s++){c.push(d[t].productList[s].skuCode);for(var q=0;q<d[t].productList[s].giftList.length;q++){c.push(d[t].productList[s].giftList[q].giftSkuCode)}}}var n=c.length;if(n<=50){ec.member.orderList.loadImg(c)}else{var f=Math.ceil(n/50);for(var t=0;t<f;t++){var s=t*50;if((t+1)==f){ec.member.orderList.loadImg(c.slice(s,n))}else{ec.member.orderList.loadImg(c.slice(s,s+50))}}}$(".button-operate-revie").each(function(){var x;var k=$(this).attr("orderInfo");if(d&&d.length>0){for(var j=0;j<d.length;j++){x=d[j];if(k==x.orderCode){$(this).attr("href","javascript:ec.member.orderList.commentsRealName("+x.orderCode+")");$(this).attr("title","我要评论");$(this).attr("innerHTML","<span>我要评论</span>");$(this).parent(".p-button").removeClass("hide")}}}});ec.member.orderList.renderPage(g)}else{ec.member.orderList.renderPage(g);ec.ui.scrollTo("#myOrder-cate");ec.member.orderList.getUserOrderRemarkStatus(u);ec.member.orderList.payClick()}}else{ec.member.orderList.bottomCheckBoxDisplay(false);$("#list-group").html('<div class="list-group-empty">您暂时没有相关记录。</div>');$("#list-pager").html("");ec.member.orderList.getUserOrderRemarkStatus(u);ec.member.orderList.payClick()}};ec.member.orderList.loadImg=function(a){new ec.ajax().get({url:pmsHttpDomain+"product/querySbomInfoByCode.json?t="+new Date().getTime()+"&sbomCode="+a.join("&sbomCode="),async:false,dataType:"jsonp",timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},successFunction:function(c){if(!c.success){alert("很抱歉！商品图片查询失败，请稍后重新操作");return}for(var b=0;b<c.data.length;b++){$(".nocomment-"+c.data[b].sbomCode).attr("src",ec.mediaPath+"/"+c.data[b].photoPath+"100_100_"+c.data[b].photoName).attr("alt",c.data[b].name);$(".nocomment-"+c.data[b].sbomCode).parent("a").attr("href","/product/"+c.data[b].prdId+".html#"+c.data[b].sbomId);$(".nocomment-"+c.data[b].sbomCode).attr("href","/product/"+c.data[b].prdId+".html#"+c.data[b].sbomId);if($(".pl-"+c.data[b].sbomCode).html()){$(".pl-"+c.data[b].sbomCode).attr("orderinfo",$(".pl-"+c.data[b].sbomCode).attr("orderinfo").replace("${proId}",c.data[b].prdId))}}ec.member.orderList.bottomCheckBoxDisplay(true);ec.ui.scrollTo("#myOrder-cate");ec.member.orderList.payClick()}})};ec.member.orderList.bottomCheckBoxDisplay=function(a){if(a&&$("#checkid").val()!="nocomment"){$("#myOrder-control-bottom").show();$("#bottomCheckAllBox").attr("checked",false)}else{$("#myOrder-control-bottom").hide()}};ec.member.orderList.productList=function(o){var r=[],t,D,g=0,l=0,s=0,n,f,u,d,a="立即支付",A=["支付宝","网银支付","货到付款","退换货","快捷支付","线下支付","财付通","华为支付","线下支付","银联在线支付"],y=$("#colid").val(),C=(y==0&&o.isHisData==0)?"0":"1",n=o.paymentList||[];if(n.length>0){u="66";d="BALANCE";for(var B=0;B<n.length;B++){if(n[B].paymentMethod!="BALANCE"&&n[B].paymentType!="66"){u=n[B].paymentType;d=n[B].paymentMethod}}}_showPaymentText=function(i,b){i=parseInt(i,10);if(!i||i<1||!b){return""}if(b=="BALANCE"&&i=="66"){return"代金券支付"}if(i==17){return"微信支付"}if(i==1&&b=="HB"){return"花呗支付"}if(i==17||i==67){return"微信支付"}if(i==82&&b=="CMBLIFE_CMBLIFE"){return"掌上生活"}if(i==82&&b=="ICBC_ICBC"){return"工行信用卡支付"}if(i==82&&b=="ABC_ABC"){return"农行信用卡支付"}if(i==82&&b=="BOC_BOC"){return"中行信用卡支付"}if(i==84){return"网银支付"}if(i==86||i==87){return"快捷支付"}if(i==83&&b=="UNIONPAY_UNIONPAY"){return"银联在线支付"}if(i==83&&b=="HUAWEIPAY_HUAWEIPAY"){return"银联云闪付（Huawei Pay）"}if(i-1>9){return"在线支付"}return A[i-1]};if($("#checkid").val()!="nocomment"){f=o.productInfoList||[]}else{f=o.productList||[]}isRefund=o.isRefund;if(o.paymentStatus==3){a="支付余款"}var E=0;E+=f.length;for(var B=0;B<f.length;B++){var e=f[B];if(e.subOrderProductInfoList!=undefined&&e.subOrderProductInfoList.length>0){E+=e.subOrderProductInfoList.length}if(e.productCouponList!=undefined){E+=e.productCouponList.length}if(o.couponList!=undefined){E+=o.couponList.length}r.push('<tr><td class="col-pro-img"><p class="p-img">');r.push('<a title="'+e.skuName+'" href="/product/'+e.productId+".html#"+e.skuId+'" target="_blank" onclick="pushProMsg('+e.skuId+",'300130101')\">");if(e.photoPath){r.push('<img class="nocomment-'+e.skuCode+'" alt="'+e.skuName+'" src="'+ec.mediaPath+e.photoPath+"100_100_"+ec.encodeForHTML(e.photoName)+'"/>')}else{r.push('<img class="nocomment-'+e.skuCode+'" alt="" src=""/>')}r.push('</a></p></td><td class="col-pro-info"><p class="p-name">');if(e.itemType=="B"||e.productTypeInfo=="P"){r.push("<b>套餐商品</b>")}r.push('<a title="'+e.skuName+'" target="_blank" ');r.push('class="nocomment-'+e.skuCode+'"href="/product/'+e.productId+".html#"+e.skuId+'" onclick="pushProMsg('+e.skuId+",'300130101')\">"+e.skuName+"</a>");r.push('</p></td><td class="col-price">');if(o.type==18&&e.productType==4&&o.balanceAmount==null){r.push("<span>");r.push("暂无报价")}else{r.push("<em>&yen;</em><span>");r.push((e.unitPrice||0).toFixed(2))}r.push('</span></td><td class="col-quty">');r.push(e.quantity+"</td>");if(B==0){r.push('<td rowspan="'+E+'" class="col-pay">');r.push("<p><em>&yen;</em><span>");if(o.type==18){r.push(o.paymentAmountTotal.toFixed(2)+"</span></p>")}else{r.push(o.paymentAmount.toFixed(2)+"</span></p>")}if(n.length>0){r.push("<p><em>"+_showPaymentText(u,d)+"</em></p>")}r.push("</td>")}if(B==0&&(o.orderStatus<5||o.orderStatus>7)){r.push('<td rowspan="'+E+'" class="col-operate">');if((o.paymentType==1||o.paymentType==2||o.paymentType==5)&&o.paymentStatus==2&&o.orderStatus!=4&&o.orderStatus!=8){}if(o.orderStatus==8||o.orderStatus==16||o.orderStatus==17){}else{if(o.orderStatus==4){if(o.type==19&&o.orderStatus!=14&&o.orderStatus!=11){r.push('<p class="p-link"><a href="/member/updateToOrder-'+o.orderCode+'">修改订单</a></p>');r.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+o.orderCode+'" onclick="ec.member.orderList.cancel(this, '+o.paymentStatus+","+o.type+');">取消订单</a></p>')}}else{if(o.orderStatus==12){}else{if(o.type&&o.type==3){}else{if(y==0||o.isHisData!=1){if(o.payFlag&&o.payFlag==1){if(o.type==18){var c=(o.paymentStatus==2||o.paymentAmountTotal<o.depositAmount)&&2!=o.isBalancePayStart;if(c){r.push('<p class="p-button"><a class="button-operate-pay" href="/payment/order-'+o.orderCode+'"><span>支付订金</span></a></p>')}else{if(o.paymentStatus==3&&o.isBalancePayStart==0){if(0!=o.cashPay){r.push('<p class="p-button"><a class="button-operate-pay" href="/payment/order-'+o.orderCode+'"><span>支付尾款</span></a></p>')}else{r.push('<p class="p-button"><a class="button-operate-pay-disabled" href="javascript:;"><span>等待尾款确定</span></a></p>')}}else{if((o.paymentStatus==3&&o.isBalancePayStart==1)||o.isBalancePayStart==4){r.push('<p class="p-button"><a class="button-operate-pay-disabled" href="javascript:;"><span>等待支付尾款</span></a></p>')}else{if((o.paymentStatus==2||o.paymentStatus==3)&&o.isBalancePayStart==2){r.push('<p class="p-button"><a class="button-operate-pay-disabled" href="javascript:;"><span>支付时间已过</span></a></p>')}}}}}else{r.push('<p class="p-button"><a class="button-operate-pay" href="/payment/order-'+o.orderCode+'"><span>');r.push(a);r.push("</span></a></p>")}}if(o.type!=14&&o.type!=28){if(o.type!=5&&o.orderStatus!=14){if(o.orderStatus!=9&&o.orderStatus!=11){if(o.type==36&&o.paymentStatus==1){}else{r.push('<p class="p-link"><a href="/member/updateToOrder-'+o.orderCode+'">修改订单</a></p>')}}}if((o.type!=3&&o.type!=17&&o.orderStatus!=14)||(o.orderStatus==9)){if((o.type==9||o.type==25||o.type==19)&&o.orderStatus==9){}else{if(o.orderStatus!=11){if(o.paymentStatus==1&&o.orderStatus==1&&o.type==33){}else{r.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+o.orderCode+'" onclick="ec.member.orderList.cancel(this, '+o.paymentStatus+","+o.type+');">取消订单</a></p>')}}}}}else{if(o.type==28){if(o.orderStatus<7){r.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+o.orderCode+'" onclick="ec.member.orderList.cancel(this, '+o.paymentStatus+","+o.type+');">取消订单</a></p>')}}else{if(o.orderStatus<7){r.push('<p class="p-link"><a href="/member/updateToOrder-'+o.orderCode+'">修改订单</a></p>');if(o.paymentStatus==2&&o.orderStatus!=11){r.push('<p class="p-link"><a href="javascript:;" data-ordercode="'+o.orderCode+'" onclick="ec.member.orderList.cancel(this, '+o.paymentStatus+","+o.type+');">取消订单</a></p>')}}}}}}}}}if((o.orderStatus==8&&o.canceledOrderDelPermission)||(o.orderStatus==7&&(o.timeDifference>=16||ec.member.orderList.GetDateDiff(o.updateDate)>=16))){r.push('<p class="p-link"><a href="javascript:;" onclick="ec.member.orderList.del(this,\''+o.orderCode+"');\">删除订单</a></p>")}r.push('<p class="p-link"><a href="/member/order-'+o.orderCode+"?isHisData="+C+'">订单详情</a></p>');if(o.isRefund==1){r.push('<p class="p-link"><a href="/member/refund?ordercode='+o.orderCode+"&isLive="+C+'">退款详情</a></p>')}r.push("</td>")}if(o.orderStatus>=5&&o.orderStatus<=7){if(B==0){r.push('<td rowspan="'+E+'" class="col-operate">');if(o.shopCode=="VMALL-HUAWEIDEVICE"&&o.orderStatus==6){}if(!e.remarkId&&o.orderStatus==7){if(e.productId){r.push('<p class="p-button hide"><a class="button-operate-revie pl-'+e.skuCode+'" href="javascript:;" orderInfo="'+o.orderCode+'"><span>我要评论</span></a></p>')}else{r.push('<p class="p-button hide"><a class="button-operate-revie pl-'+e.skuCode+'" href="javascript:;" orderInfo="'+o.orderCode+'"><span>我要评论</span></a></p>')}}var c=e.productType!=2&&o.type!=12&&o.type!=14&&o.type!=28&&o.type!=36&&o.type!=3&&o.type!=9&&o.type!=19&&o.orderStatus==7;if(y==0){if(o.orderStatus==7&&(o.timeDifference>=16||ec.member.orderList.GetDateDiff(o.updateDate)>=16)){r.push('<p class="p-link"><a href="javascript:;" onclick="ec.member.orderList.del(this,\''+o.orderCode+"');\">删除订单</a></p>")}else{if(c){r.push('<p class="p-link"><a href="javascript:;" data-href="/member/exchange/get-'+o.orderCode+'" onclick="ec.member.orderList.exchangeTip(this,'+o.orderCode+')">退换货</a></p>')}}}else{if(o.orderStatus==7&&(o.timeDifference>=16||ec.member.orderList.GetDateDiff(o.updateDate)>=16)){r.push('<p class="p-link"><a href="javascript:;" onclick="ec.member.orderList.del(this,\''+o.orderCode+"');\">删除订单</a></p>")}else{if(c){r.push('<p class="p-link"><a href="javascript:;" data-href="/member/exchange/get-'+o.orderCode+'" onclick="ec.member.orderList.exchangeTip(this,'+o.orderCode+')">退换货</a></p>')}}}r.push('<p class="p-link"><a href="/member/order-'+o.orderCode+"?isHisData="+C+'">订单详情</a></p>');if(o.isRefund==1){r.push('<p class="p-link"><a href="/member/refund?ordercode='+o.orderCode+"&isLive="+C+'">退款详情</a></p>')}r.push("</td>")}}r.push("</tr>");var h=false;var w="";if(e.productCouponList!=undefined&&e.productCouponList.length>0){for(var q=0;q<e.productCouponList.length;q++){w+='<tr class="o-gift">';w+='<td class="col-gift" colspan="2">';w+='<p class="d-name"><b>赠品</b>'+e.productCouponList[q].couponName+"</p>";w+="</td>";w+='<td class="col-price">--</td>';w+='<td class="col-quty">'+e.productCouponList[q].quantity+"</td>";w+="</tr>"}}var F=0;if(e.subOrderProductInfoList!=undefined&&e.subOrderProductInfoList.length>0){for(var x=0;x<e.subOrderProductInfoList.length;x++){var v=e.subOrderProductInfoList[x];if(F==0&&(v.itemType=="B"||v.productTypeInfo=="P")){r.push(w);h==true;F++}r.push('<tr><td class="col-pro-img"><p class="p-img">');r.push('<a title="'+v.skuName+'" href="/product/'+v.productId+".html#"+v.skuId+'" target="_blank" onclick="pushProMsg('+v.skuId+",'300130101')\">");if(v.photoPath){r.push('<img class="nocomment-'+v.skuCode+'" alt="'+v.skuName+'" src="'+ec.mediaPath+v.photoPath+"100_100_"+ec.encodeForHTML(v.photoName)+'"/>')}else{r.push('<img class="nocomment-'+v.skuCode+'" alt="" src=""/>')}r.push("</a></p>");r.push("</td>");r.push('<td class="col-pro-info"><p class="p-name">');if(v.itemType=="B"||v.productTypeInfo=="P"){r.push("<b>套餐商品</b>")}if(v.itemType=="G"){r.push("<b>配</b>")}r.push('<a title="'+v.skuName+'" target="_blank" ');r.push('class="nocomment-'+v.skuCode+'"href="/product/'+v.productId+".html#"+v.skuId+'" onclick="pushProMsg('+v.skuId+",'300130101')\">"+v.skuName+"</a>");r.push('</p></td><td class="col-price">');if(o.type==18&&v.productType==4&&o.balanceAmount==null){r.push("<span>");r.push("暂无报价")}else{r.push("<em>&yen;</em><span>");r.push((v.unitPrice||0).toFixed(2))}r.push('</span></td><td class="col-quty">');r.push(v.quantity+"</td>");r.push("</tr>")}}if(!h&&F==0&&e.productCouponList!=null&&e.productCouponList.length>0){for(var m=0;m<e.productCouponList.length;m++){r.push('<tr class="o-gift">');r.push('<td class="col-gift" colspan="2">');r.push('<p class="d-name"><b>赠品</b>'+e.productCouponList[m].couponName+"</p>");r.push("</td>");r.push('<td class="col-price">--</td>');r.push('<td class="col-quty">'+e.productCouponList[m].quantity+"</td>");r.push("</tr>")}F++}if(o.couponList!=null&&o.couponList.length>0&&B==f.length-1){for(var z=0;z<o.couponList.length;z++){r.push('<tr class="o-gift">');r.push('<td class="col-gift" colspan="2">');r.push('<p class="d-name"><b>赠品</b>'+o.couponList[z].couponName+"</p>");r.push("</td>");r.push('<td class="col-price">--</td>');r.push('<td class="col-quty">'+o.couponList[z].quantity+"</td>");r.push("</tr>")}}}return r.join("")};ec.member.orderList.skuList=function(c){var b=[];if(c!=null&&c.length>0){for(var a=0;a<c.length;a+=1){b.push("<em>"+c[a]+"</em>")}}return b.join("")};ec.member.orderList.depositList=function(a){var b=[];b.push('<div class="o-deposit">');b.push('<table border="0" cellpadding="0" cellspacing="0">');b.push('<tbody><tr><td class="col-deposit"><p class="d-name">阶段1：订金</p></td>');b.push('<td class="col-price"><em>¥</em><span>'+a.depositAmount.toFixed(2)+"</span></td>");b.push('<td class="col-quty">-</td>');if(a.paymentStatus==2){b.push('<td class="col-pay"><span>--</span></td>');b.push('<td class="col-operate">待支付</td>')}else{if(a.paymentStatus==3){if(a.paymentAmountTotal>=a.depositAmount){b.push('<td class="col-pay"><em>¥</em><span>'+a.depositAmount.toFixed(2)+"</span></td>");b.push('<td class="col-operate">已支付</td>')}else{if(a.paymentAmountTotal<a.depositAmount&&a.paymentAmountTotal>0){b.push('<td class="col-pay"><em>¥</em><span>'+a.paymentAmountTotal.toFixed(2)+"</span></td>");b.push('<td class="col-operate">部分支付订金</td>')}}}else{b.push('<td class="col-pay"><em>¥</em><span>'+a.depositAmount.toFixed(2)+"</span></td>");b.push('<td class="col-operate">已支付</td>')}}b.push('</tr><tr class="disabled">');if(a.balanceStartTime!=""&&a.balanceStartTime!=null){b.push('<td class="col-deposit">阶段2：尾款('+a.balanceStartTime+"至"+a.balanceEndTime+"支付)</td>")}else{b.push('<td class="col-deposit">阶段2：尾款(暂时无法获取尾款支付时间，请您稍后再试试)')}b.push('<td class="col-price">');if(null!=a.balanceAmount){b.push("<em>¥</em><span>");b.push((a.balanceAmount).toFixed(2))}else{b.push("<span>");b.push("暂无报价")}b.push("</span></td>");b.push('<td class="col-quty">-</td>');b.push('<td class="col-pay">');if(null!=a.balancePay){b.push("<em>¥</em><span>");b.push(a.balancePay.toFixed(2))}else{b.push("<span>");b.push("--")}b.push("</span></td>");if(a.paymentStatus==1){b.push('<td class="col-operate">已支付</td>')}else{if(a.paymentStatus==2&&a.isBalancePayStart==0){b.push('<td class="col-operate">待支付</td>')}else{if(a.isBalancePayStart==0){if(a.paymentAmountTotal<=a.depositAmount){b.push('<td class="col-operate">待支付</td>')}else{if(a.paymentAmountTotal<a.cashPay&&a.paymentAmountTotal>a.depositAmount){b.push('<td class="col-operate">部分支付尾款</td>')}else{if(a.paymentAmountTotal==a.cashPay){b.push('<td class="col-operate">已支付</td>')}}}}else{if(a.isBalancePayStart==1){b.push('<td class="col-operate">支付时间未到</td>')}else{if(a.isBalancePayStart==4){b.push('<td class="col-operate"></td>')}else{if(a.isBalancePayStart==2){b.push('<td class="col-operate">支付期已过</td>')}}}}}}b.push("</tr></tbody></table></div>");return b.join("")};ec.member.orderList.exchangeTip=function(a){new ec.box($("#exchange-agreement").val(),{boxclass:"ol_box_4 ol_box_agreement",title:"退换货办理协议",width:678,height:350,autoHeight:false,onok:function(){location.href=$(a).attr("data-href")}}).open()};ec.member.orderList.exchangeTip=function(b,a){$.ajax({type:"POST",url:"/member/exchange/getReturnExchangeFlag.json",data:{orderCode:a,isLive:$("#colid").val()},async:false,dataType:"json",success:function(c){if(null!=c&&c.success){var d=c.returnExchangeFlag;if(d==0){new ec.box($("#exchange-timeout").val(),{boxclass:"ol_box_4",autoHeight:false,showButton:false}).open()}else{if(d=="35210"){new ec.box($("#exchange-error").val(),{boxclass:"ol_box_4",autoHeight:false,showButton:false}).open()}else{new ec.box($("#exchange-agreement").val(),{boxclass:"ol_box_4 ol_box_title",title:"退换货办理协议",width:700,autoHeight:false,onok:function(){location.href=$(b).attr("data-href")+"/"+d}}).open()}}}else{alert("获取请求失败");return false}}})};ec.member.orderList.del=function(c,a){var b='<span style="font-size:16px;">确认删除此订单?</span><br/><span style="font-size:14px;color:#333;">订单删除后将无法恢复,请谨慎操作!</span>';if(ec.ui.confirm(c,b)){new ec.ajax().get({url:"/member/order/del/"+a+".json",data:{isLive:$("#colid").val()},timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},beforeSendFunction:function(){ec.ui.loading.show({modal:false})},afterSendFunction:ec.ui.loading.hide,successFunction:function(e){var f="";if(!e.success){var f="登录已超时,请重新登录";var d=[];if(e.code!="login"){f=e.msg}d.push('<div class="box-prompt-error-area">');d.push('<div class="h"><i></i></div>');d.push('<div class="b"><span id="prompt-delorder" style="color:#3a3a3a;">'+f+"</span></div>");d.push("</div>");d.push('<div class="box-custom-button"><a class="box-ok box-button-style-1" href="javascript:;"><span>确定</span></a></div>');$("#msg-delorder-ok").html(d.join(""))}else{var d=[];d.push('<div class="box-right-1"><span id="prompt-delorder">温馨提示：订单删除成功</span></div>');d.push('<div class="box-button"><a class="box-ok box-button-style-1" href="javascript:;"><span>确定</span></a></div>');$("#msg-delorder-ok").html(d.join(""))}new ec.box($("#msg-delorder-ok").val(),{boxclass:"ol_box_4 small",boxid:"orderDelBox",title:"",modal:true,showButton:false,onok:function(g){if(e.code!="login"){window.location.href="/member/order?t="+new Date().getTime()}g.close()},onclose:function(g){if(e.code!="login"){window.location.href="/member/order?t="+new Date().getTime()}}}).open()}})}};var _del;ec.member.orderList.cancel=function(d,b,c){$("#cancelReson").val("");var a=$(d).attr("data-ordercode");_del=function(e){if(e){e.close()}new ec.ajax().get({url:"/member/cancelOrder-"+a+".json",data:{cancelReson:$("#cancelReson").val()},timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},beforeSendFunction:function(){ec.ui.loading.show({modal:false})},errorFunction:function(f){ec.ui.loading.hide()},afterSendFunction:ec.ui.loading.hide,successFunction:function(i){if(!i.success){ec.showError(i);return}var h=[],k=i.order;var f=$(d).closest("td").html("<p class='p-link'><a href='/member/order-"+k.code+"' >订单详情</a></p>").closest(".list-group-item");var g=f.find(".o-info");var j="已取消";if(i.orderStatus==16){j="取消处理中"}if(k.paymentStatus=="1"){j+="&nbsp;|&nbsp;已付款"}g.find(".col-state").html(j);h.push('<div class="col-info">');if(k.type!=18&&(k.paymentStatus==2||k.paymentStatus==3)&&(k.orderStatus==3||(k.orderStatus<3&&k.orderSource!=2))){h.push('<input type="checkbox" class="checkbox" name="payCheck" paymentStatus="'+k.paymentStatus+'"clearOrder="'+tempClearingTips+'" value="'+k.orderCode+'"/>')}h.push('<span class="o-date">');h.push(new Date(k.orderDate).format("yyyy-MM-dd HH:mm"));h.push('</span><span class="o-no">');h.push('订单号：<a href="/member/order-'+k.code+'" title="'+k.code+'">'+k.code+"</a></span>");if(k.type==33){h.push('<span class="o-icon-1">拼购</span>')}if(k.type==26){h.push('<span class="icon-priority"></span>')}h.push('</div><div class="col-state">'+j+"</div></div>");g.html(h.join(""));ec.member.orderList.orderCount();ec.member.orderList.box=new ec.box($("#cancel-msg-tpl").val(),{boxclass:"ol_box_4",title:"订单取消申请已提交",showButton:false,onok:function(l){l.close()}}).open();return}})};ec.member.orderList.box=new ec.box($("#order-cancel").val(),{boxclass:"ol_box_4",title:"订单取消申请",boxid:"orderDelBox",width:700,modal:true,showButton:false,}).open();ec.member.orderList.orderCount()};ec.member.orderList.seltime=function(g,c){if($(g).parent("li").hasClass("current")){return}$("#colid").val(c);$("#checkid").val("all");$("#myOrder-cate li").removeClass("current");$("#myOrder-cate li:first").addClass("current");$(g).parent("li").addClass("current").siblings().removeClass("current");var a={pageNumber:1},d=$("#count-seltime-2").attr("data-num"),b=$("#count-seltime-3").attr("data-num"),f=$("#nocommentNum").attr("data-num"),e=$("#nocommentNum").attr("data-his");ec.member.orderList.load(a,c);if(c==0){$("#nocommentNum").parents("li").hide();$("#nocommentNum").text(e);if(e>0){$("#nocommentNum").show()}else{$("#nocommentNum").hide()}$("#count-seltime-2").text(0).closest("li").hide();$("#count-seltime-3").text(0).closest("li").hide()}else{$("#nocommentNum").parents("li").show();$("#count-seltime-2").text(d).closest("li").show();if(d>0){$("#count-seltime-2").show()}else{$("#count-seltime-2").hide()}$("#count-seltime-3").text(b).closest("li").show();if(b>0){$("#count-seltime-3").show()}else{$("#count-seltime-3").hide()}$("#nocommentNum").text(f);if(f>0){$("#nocommentNum").show()}else{$("#nocommentNum").hide()}}};ec.member.orderList.check=function(c,b){if($(c).parent("li").hasClass("current")){return}$("#checkid").val(b);$(c).parent("li").addClass("current").siblings().removeClass("current");var a={pageNumber:1};ec.member.orderList.load(a,b)};ec.member.orderList.renderPage=function(a){if(a.totalPage==1){$("#list-pager").hide();return}else{$("#list-pager").show()}$("#list-pager").pager({pageNumber:a.pageNumber,pageCount:a.totalPage,pageSize:5,text:{first:"|&lt;",pre:"&lt",next:"&gt;",last:"&gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.member.orderList.load})};ec.member.orderList.openLog=function(e,c){var b="/member/logisticslog.json",f=ec.member.orderList,d=$("#interface-dialog-"+c),a=$("#interface-msg-"+c);new ec.ajax().get({url:b,data:{orderCode:c,isHisData:$("#colid").val()},timeout:10000,timeoutFunction:function(){a.html('<div class="o-logistics-list-loading">超时，请重试！</div>')},successFunction:function(g){if(!g.success){a.html('<div class="o-logistics-list-loading">超时，请重试！</div>');return}if((null!=g.logisticsLogList)&&(g.logisticsLogList.length>0)){a.html(ec.member.orderList.interfaceTpl.parse("interface",g.logisticsLogList))}else{a.html('<div class="o-logistics-list-empty">暂无物流信息</div>')}$(".o-logistics tbody tr:first").addClass("tr-latest")}})};ec.member.orderList.confirmDelivery=function(c,a,b){new ec.box($("#box-confirm").val(),{boxclass:"ol_box_4",width:600,title:"确认收货成功",showButton:false,onok:function(d){new ec.ajax().get({url:"/member/confirmDelivery-"+a+".json",timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},beforeSendFunction:function(){ec.ui.loading.show({modal:false})},afterSendFunction:ec.ui.loading.hide,successFunction:function(e){if(!e.success){alert("确认收货失败！");return}$(c).hide();var f="/member/addUserRemarkView?orderCode="+a;d.setTitle("温馨提示");d.setContent($("#box-pj").val().replace("/member/prdRemarkView.html",f));d.setPosition()},errorFunction:function(){alert("确认收货失败！")}})}}).open()};ec.member.orderList.tapcheckAll=function(){if($("#checkAllBox").attr("checked")){$("input[name='payCheck']").each(function(){this.checked=true});$("#bottomCheckAllBox").attr("checked",true)}else{$("input[name='payCheck']").each(function(){this.checked=false});$("#bottomCheckAllBox").attr("checked",false)}};ec.member.orderList.mergePay=function(){var e=$("#topButton").attr("class");if(e=="button-operate-merge-pay"){var c="";var a=document.getElementsByName("payCheck");var b=ec.member.orderList.checkPayCheck(a);if(!b){alert("请选择要合并付款的订单")}else{for(var d=0;d<a.length;d++){if(a[d].checked){c+=a[d].value+"|"}}new ec.ajax().get({url:"/validate/orderClear.json",data:{orderList:c},timeout:10000,timeoutFunction:function(){},successFunction:function(f){if(f.success){$("#clearPay").attr({action:"/clearPay/order",method:"post"});$("#clear-Ips").val(JSON.stringify(f.ips));gid("clearPay").submit()}else{if(f.code=="login"){ec.account.loginName="";ec.account.afterLogin(function(){window.location.href=window.location.href})}else{if(f.payNoOne=="unPay"){$("#unPay-inOnce").val('<div class="box-errors-2" id="tipContent">您选择的订单由不同商家发货并提供售后服务，暂不支持合并支付，请分别进行支付。</div><div class="box-button"><a href="javascript:;" class="box-sure" onclick="ec.member.orderList.boxCancle()"><span>确认</span></a></div>');ec.member.orderList.unpayTip()}else{$("#unPay-inOnce").val('<div class="box-errors-2" id="tipContent">非常抱歉，订单暂时无法支付，请稍后再试或联系客服。</div><div class="box-button"><a href="javascript:;" class="box-sure" onclick="ec.member.orderList.boxCancle()"><span>确认</span></a></div>');ec.member.orderList.unpayTip()}}}}})}}};ec.member.orderList.checkPayCheck=function(c){var a=false;for(var b=0;b<c.length;b++){if(c[b].checked){a=true;break}}return a};ec.member.orderList.orderCount=function(){new ec.ajax().get({url:domainMain+"/member/orderCount.json?t="+new Date().getTime(),async:false,timeout:10000,successFunction:function(a){if(!a.success){return}var b=parseInt(a.orderCount.unpaidOrderCount+a.orderCount.partPaidOrderCount);if(b!=0){$("#count-seltime-2").show();$("#count-seltime-2").text(b);$("#count-seltime-2").attr("data-num",b)}else{$("#count-seltime-2").hide();$("#count-seltime-2").text(b);$("#count-seltime-2").attr("data-num",b)}$("#count-seltime-3").text(a.orderCount.unreceiptOrderCount?a.orderCount.unreceiptOrderCount:0);$("#count-seltime-3").attr("data-num",a.orderCount.unreceiptOrderCount?a.orderCount.unreceiptOrderCount:0)}})};ec.member.orderList.allOrderCount=function(){new ec.ajax().get({url:domainRms+"/comment/getNoCommentPrdCount.json?t="+new Date().getTime(),dataType:"jsonp",data:{tab:"nocomment",dateType:"1"},timeout:10000,timeoutFunction:function(){alert("读取超时，请重试！")},successFunction:function(a){var b=parseInt($("#count-seltime-2-wechat").html())+parseInt($("#count-seltime-3-wechat").html());if(b>0){$("#li-order-small span").html("小程序订单<em>("+b+")</em>");ec.util.cookie.set("vmallOrderCountWechat",b)}else{$("#li-order-small span").html("小程序订单");ec.util.cookie.set("vmallOrderCountWechat",0)}if(a.resultCode!=0){alert("很抱歉！待评价查询失败，请稍后重新操作");return}var g,e,d,f;d=parseInt(a.data.count?a.data.count:0);f=0;if(d>0){$("#nocommentNum").text(d).show()}else{$("#nocommentNum").text(0).hide()}$("#nocommentNum").attr("data-num",d);$("#nocommentNum").attr("data-his",f);e=f;if(e>0){$("#count-seltime-1").text(e).show()}else{$("#count-seltime-1").text(0).hide()}g=parseInt(a.data.count?a.data.count:0)+parseInt($("#count-seltime-2").html())+parseInt($("#count-seltime-3").html());if(g>0){$("#count-seltime-0").text(g).show()}else{$("#count-seltime-0").text(0).hide()}var c=g+e;if(c>0){$("#li-order span").html("我的订单<em>("+c+")</em>");ec.util.cookie.set("vmallOrderCount",c)}else{$("#li-order span").html("我的订单");ec.util.cookie.set("vmallOrderCount",0)}$("#ec-tab").navMove({boxClass:"ec-tab-arrow"})}})};ec.member.orderList.urlStatus=function(){var a=window.location.href;if(a.search(/unpaid/)!=-1){$("#list-group").html("");var b=$("#myOrder-cate li").eq(1).find("a");ec.member.orderList.check(b,"unpaid")}else{if(a.search(/nocomment/)!=-1){$("#list-group").html("");var b=$("#myOrder-cate li").eq(2).find("a");ec.member.orderList.check(b,"nocomment")}else{if(a.search(/send/)!=-1){$("#list-group").html("");var b=$("#myOrder-cate li").eq(3).find("a");ec.member.orderList.check(b,"send")}}}};ec.member.orderList.payClick=function(){$("input[name='payCheck']").bind("click",function(){var a=0;$("input[name='payCheck']").each(function(b){if(this.checked){a++}});if(a==$("input[name='payCheck']").length&&$("input[name='payCheck']").length>1){$("#checkAllBox").attr("checked",true);$("#bottomCheckAllBox").attr("checked",true)}else{$("#checkAllBox").attr("checked",false);$("#bottomCheckAllBox").attr("checked",false)}})};ec.ready(function(){if(ec.isIE6){$(".o-logistics").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")})}$("#ec-tab").navMove({boxClass:"ec-tab-arrow"});ec.member.orderList.urlStatus();$("#checkAllBox").click(function(){if(this.checked){$("input[name='payCheck']").each(function(a){this.checked=true});$("#bottomCheckAllBox").attr("checked",true)}else{$("input[name='payCheck']").each(function(){this.checked=false});$("#bottomCheckAllBox").attr("checked",false)}});$("#bottomCheckAllBox").click(function(){if(this.checked){$("input[name='payCheck']").each(function(){this.checked=true});$("#checkAllBox").attr("checked",true)}else{$("input[name='payCheck']").each(function(){this.checked=false})}});ec.member.orderList.allOrderCount();ec.member.orderList.GetDateDiff=function(a){var c=a;var b=new Date().getTime();var d=parseInt(Math.abs(c-b)/(1000*60*60*24));return d}});$(function(){$("#cancelOption li").live("click",function(){$(this).children("input").attr("checked","checked");$("#selectReson").html($("input[name='resonType']:checked")[0].nextSibling.nodeValue);$("#cancelReson").val($("input[name='resonType']:checked").val());$("#selectReson").addClass("click");$("#cancelErrorMessage").hide();$(".order-cancel").find(".order-cancel-pulldown").css({border:"1px solid #d6d6d6"})});$("#okButton").live("click",function(){if($("#cancelReson").val()==""){$("#cancelErrorMessage").show();$(".order-cancel").find(".order-cancel-pulldown").css({border:"1px solid #ca141d"});return}_del();ec.member.orderList.box.close()});$("#cancelButton").live("click",function(){ec.member.orderList.box.close()});if($("input[name='payCheck']").length==0||$("input[name='payCheck']").length==1){$("#myOrder-control-bottom").hide();$("#myOrder-control-bottom-up").hide()}$("input[name='payCheck']").bind("click",function(){var a=0;$("input[name='payCheck']").each(function(b){if(this.checked){a++}});if(a==$("input[name='payCheck']").length&&$("input[name='payCheck']").length>1){$("#checkAllBox").attr("checked",true);$("#bottomCheckAllBox").attr("checked",true)}else{$("#checkAllBox").attr("checked",false);$("#bottomCheckAllBox").attr("checked",false)}})});function pushProMsg(a,b){var c={UID:ec.util.cookie.get("uid"),TID:getPtid(),TIME:getTime(),CONTENT:{SKUID:a,click:"1"}};ec.account.dapPushMsg(b,c,"click");ec.code.addAnalytics({hicloud:true});_paq.push(["trackLink",b,"link",c])}ec.member.orderList.boxCancle=function(a){$("#ol_box").remove();$(".ol_box_mask").remove()};